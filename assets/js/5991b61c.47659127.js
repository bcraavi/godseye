"use strict";(globalThis.webpackChunkgodseye=globalThis.webpackChunkgodseye||[]).push([[2371],{412(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"strategy/multi-tenant","title":"Multi-Tenant Architecture","description":"GodsEye uses a Bridge Model multi-tenancy approach -- a tiered isolation strategy that lets each tenant operate at the isolation level matching their size, compliance posture, and budget. Tenant tiers map to pricing tiers: Free users get Standard isolation, Team gets Enterprise isolation, Enterprise gets Premium isolation.","source":"@site/docs/strategy/multi-tenant.md","sourceDirName":"strategy","slug":"/strategy/multi-tenant","permalink":"/godseye/strategy/multi-tenant","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Multi-Tenant Architecture","sidebar_label":"\ud83c\udfe2 Multi-Tenant Architecture"},"sidebar":"architectureSidebar","previous":{"title":"\u2601\ufe0f Multi-Cloud Strategy","permalink":"/godseye/strategy/multi-cloud"},"next":{"title":"\ud83d\udd3a Triplet Model","permalink":"/godseye/strategy/triplet-model"}}');var a=t(4848),i=t(8453);const s={sidebar_position:3,title:"Multi-Tenant Architecture",sidebar_label:"\ud83c\udfe2 Multi-Tenant Architecture"},d="\ud83c\udfe2 Multi-Tenant Architecture",l={},o=[{value:"Tenant Tiers",id:"tenant-tiers",level:2},{value:"Data Isolation",id:"data-isolation",level:2},{value:"Schema-per-Tenant (Standard)",id:"schema-per-tenant-standard",level:3},{value:"Dedicated DB (Enterprise / Premium)",id:"dedicated-db-enterprise--premium",level:3},{value:"Encryption and Residency",id:"encryption-and-residency",level:3},{value:"Compute Isolation",id:"compute-isolation",level:2},{value:"Network Policies",id:"network-policies",level:3},{value:"Service Mesh (Istio)",id:"service-mesh-istio",level:3},{value:"Tenant Onboarding Flow",id:"tenant-onboarding-flow",level:2},{value:"Onboarding Steps Summary",id:"onboarding-steps-summary",level:3},{value:"Tenant Configuration",id:"tenant-configuration",level:2},{value:"Request Routing with Tenant Context",id:"request-routing-with-tenant-context",level:2},{value:"Scaling and Noisy-Neighbor Prevention",id:"scaling-and-noisy-neighbor-prevention",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"-multi-tenant-architecture",children:"\ud83c\udfe2 Multi-Tenant Architecture"})}),"\n",(0,a.jsxs)(n.p,{children:["GodsEye uses a ",(0,a.jsx)(n.strong,{children:"Bridge Model"})," multi-tenancy approach -- a tiered isolation strategy that lets each tenant operate at the isolation level matching their size, compliance posture, and budget. Tenant tiers map to ",(0,a.jsx)(n.a,{href:"/godseye/strategy/open-core",children:"pricing tiers"}),": Free users get Standard isolation, Team gets Enterprise isolation, Enterprise gets Premium isolation."]}),"\n",(0,a.jsx)(n.h2,{id:"tenant-tiers",children:"Tenant Tiers"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Dimension"}),(0,a.jsx)(n.th,{children:"Standard"}),(0,a.jsx)(n.th,{children:"Enterprise"}),(0,a.jsx)(n.th,{children:"Premium"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Target"})}),(0,a.jsx)(n.td,{children:"Smaller retailers"}),(0,a.jsx)(n.td,{children:"Mid-market ($1-10B rev)"}),(0,a.jsx)(n.td,{children:"Large retailers ($10B+) / strict compliance"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Compute"})}),(0,a.jsx)(n.td,{children:"Shared K8s namespaces"}),(0,a.jsx)(n.td,{children:"Shared cluster, dedicated node pools"}),(0,a.jsx)(n.td,{children:"Dedicated clusters"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Database"})}),(0,a.jsx)(n.td,{children:"Shared PostgreSQL, schema-per-tenant"}),(0,a.jsx)(n.td,{children:"Dedicated DB instance per tenant"}),(0,a.jsx)(n.td,{children:"Dedicated DB + dedicated cloud project"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Encryption"})}),(0,a.jsx)(n.td,{children:"Platform-managed keys"}),(0,a.jsx)(n.td,{children:"Per-tenant keys (cloud KMS)"}),(0,a.jsx)(n.td,{children:"Per-tenant keys + HSM-backed"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Network"})}),(0,a.jsx)(n.td,{children:"Namespace-level network policies"}),(0,a.jsx)(n.td,{children:"Node-pool-level isolation + mTLS"}),(0,a.jsx)(n.td,{children:"Dedicated VPC / VNet"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Compliance"})}),(0,a.jsx)(n.td,{children:"SOC 2 shared"}),(0,a.jsx)(n.td,{children:"SOC 2 + PCI-DSS Level 2"}),(0,a.jsx)(n.td,{children:"PCI-DSS Level 1 scope, HIPAA-ready"})]})]})]}),"\n",(0,a.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Premium Tier"\n        direction TB\n        PC[Dedicated Cluster] --\x3e PD[Dedicated DB]\n        PC --\x3e PV[Dedicated VPC]\n        PD --\x3e PK[HSM-Backed Keys]\n    end\n\n    subgraph "Enterprise Tier"\n        direction TB\n        EC[Shared Cluster / Dedicated Node Pool] --\x3e ED[Dedicated DB Instance]\n        EC --\x3e EN[Node-Pool Isolation]\n        ED --\x3e EK[Per-Tenant KMS Keys]\n    end\n\n    subgraph "Standard Tier"\n        direction TB\n        SC[Shared K8s Namespace] --\x3e SD[Shared DB / Schema Isolation]\n        SC --\x3e SN[Namespace Network Policy]\n        SD --\x3e SK[Platform-Managed Keys]\n    end\n\n    style PC fill:#e74c3c,color:#fff\n    style PD fill:#e74c3c,color:#fff\n    style PV fill:#e74c3c,color:#fff\n    style PK fill:#e74c3c,color:#fff\n    style EC fill:#f39c12,color:#fff\n    style ED fill:#f39c12,color:#fff\n    style EN fill:#f39c12,color:#fff\n    style EK fill:#f39c12,color:#fff\n    style SC fill:#3498db,color:#fff\n    style SD fill:#3498db,color:#fff\n    style SN fill:#3498db,color:#fff\n    style SK fill:#3498db,color:#fff'}),"\n",(0,a.jsx)(n.h2,{id:"data-isolation",children:"Data Isolation"}),"\n",(0,a.jsx)(n.h3,{id:"schema-per-tenant-standard",children:"Schema-per-Tenant (Standard)"}),"\n",(0,a.jsxs)(n.p,{children:["Each tenant gets a dedicated PostgreSQL schema within a shared database instance. All queries are scoped by ",(0,a.jsx)(n.code,{children:"tenant_id"})," enforced at the ORM/query layer and verified via row-level security (RLS) policies."]}),"\n",(0,a.jsx)(n.h3,{id:"dedicated-db-enterprise--premium",children:"Dedicated DB (Enterprise / Premium)"}),"\n",(0,a.jsx)(n.p,{children:"Enterprise and Premium tenants receive a fully dedicated database instance provisioned via Terraform. Connection routing is handled at the platform layer -- the application resolves the correct connection pool based on the tenant context extracted from the incoming request."}),"\n",(0,a.jsx)(n.h3,{id:"encryption-and-residency",children:"Encryption and Residency"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"At rest"}),": AES-256 encryption. Standard tenants share a platform key; Enterprise/Premium tenants get a dedicated key in the cloud KMS (AWS KMS / GCP Cloud KMS / Azure Key Vault)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Data residency"}),": Per-tenant configuration specifies allowed regions. The platform enforces that tenant data is stored and processed only in those regions."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Cross-tenant leakage prevention"}),": Query-level enforcement (RLS + ORM tenant scoping), plus audit logging of every cross-schema/cross-DB access attempt."]}),"\n"]}),"\n",(0,a.jsx)(n.mermaid,{value:'graph LR\n    subgraph "Request Path"\n        REQ[Incoming Request] --\x3e GW[API Gateway]\n        GW --\x3e|Extract tenant_id| TR[Tenant Router]\n    end\n\n    subgraph "Standard Tenants"\n        TR --\x3e|standard| SP[(Shared PostgreSQL)]\n        SP --\x3e S1[Schema: tenant_001]\n        SP --\x3e S2[Schema: tenant_002]\n        SP --\x3e S3[Schema: tenant_003]\n    end\n\n    subgraph "Enterprise Tenants"\n        TR --\x3e|enterprise| ED1[(DB: tenant_100)]\n        TR --\x3e|enterprise| ED2[(DB: tenant_101)]\n    end\n\n    subgraph "Premium Tenants"\n        TR --\x3e|premium| PD1[(Isolated DB: tenant_200)]\n    end\n\n    subgraph "Key Management"\n        KMS[Cloud KMS]\n        KMS --\x3e PK1[Platform Key]\n        KMS --\x3e TK1[Tenant-100 Key]\n        KMS --\x3e TK2[Tenant-101 Key]\n        KMS --\x3e TK3[Tenant-200 Key + HSM]\n    end\n\n    PK1 -.->|encrypts| SP\n    TK1 -.->|encrypts| ED1\n    TK2 -.->|encrypts| ED2\n    TK3 -.->|encrypts| PD1'}),"\n",(0,a.jsx)(n.h2,{id:"compute-isolation",children:"Compute Isolation"}),"\n",(0,a.jsx)(n.h3,{id:"network-policies",children:"Network Policies"}),"\n",(0,a.jsx)(n.p,{children:"Default-deny between all tenant namespaces. Ingress/egress rules are explicitly defined per namespace, allowing only platform services (API gateway, service mesh control plane) to communicate cross-namespace."}),"\n",(0,a.jsx)(n.h3,{id:"service-mesh-istio",children:"Service Mesh (Istio)"}),"\n",(0,a.jsxs)(n.p,{children:["All service-to-service calls use mTLS. Tenant context is propagated via request headers (",(0,a.jsx)(n.code,{children:"X-Tenant-ID"}),", ",(0,a.jsx)(n.code,{children:"X-Tenant-Tier"}),"). Authorization policies in Istio enforce that a service can only access resources for the tenant identified in the request."]}),"\n",(0,a.jsx)(n.mermaid,{value:'graph TB\n    subgraph "Cloud Region"\n        LB[Load Balancer / CloudFlare]\n\n        subgraph "K8s Cluster - Shared"\n            ISCP[Istio Control Plane]\n\n            subgraph "Namespace: tenant-001 (Standard)"\n                S1A[Pod: API] --\x3e S1B[Pod: Worker]\n                S1A -.->|mTLS| S1B\n            end\n\n            subgraph "Namespace: tenant-002 (Standard)"\n                S2A[Pod: API] --\x3e S2B[Pod: Worker]\n                S2A -.->|mTLS| S2B\n            end\n\n            subgraph "Node Pool: tenant-100 (Enterprise)"\n                E1A[Pod: API] --\x3e E1B[Pod: Worker]\n                E1A -.->|mTLS| E1B\n            end\n\n            NP[Network Policy: Default Deny Cross-Namespace]\n        end\n\n        subgraph "K8s Cluster - Dedicated (Premium)"\n            subgraph "Namespace: tenant-200"\n                P1A[Pod: API] --\x3e P1B[Pod: Worker]\n                P1A -.->|mTLS| P1B\n            end\n        end\n\n        LB --\x3e ISCP\n        ISCP --\x3e S1A\n        ISCP --\x3e S2A\n        ISCP --\x3e E1A\n        ISCP --\x3e P1A\n    end'}),"\n",(0,a.jsx)(n.h2,{id:"tenant-onboarding-flow",children:"Tenant Onboarding Flow"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Admin as Platform Admin\n    participant CP as Control Plane\n    participant TF as Terraform / Crossplane\n    participant K8s as Kubernetes\n    participant DNS as CloudFlare DNS\n    participant DI as Data Importer\n\n    Admin->>CP: Create Tenant (name, tier, config)\n    CP->>CP: Validate & assign tenant_id\n\n    alt Standard Tier\n        CP->>TF: Provision DB schema in shared instance\n    else Enterprise Tier\n        CP->>TF: Provision dedicated DB instance\n    end\n\n    TF--\x3e>CP: DB ready\n\n    CP->>K8s: Create namespace / node pool\n    K8s--\x3e>CP: Compute ready\n\n    CP->>K8s: Deploy tenant ConfigMap & Secrets\n    CP->>K8s: Apply NetworkPolicy & Istio AuthZ\n\n    CP->>DNS: Create subdomain (tenant.godseye.io)\n    DNS--\x3e>CP: DNS propagated\n\n    CP->>DI: Trigger initial data import\n    DI->>DI: Import products, inventory, historical orders\n    DI--\x3e>CP: Import complete\n\n    CP->>CP: Activate tenant\n    CP--\x3e>Admin: Tenant live"}),"\n",(0,a.jsx)(n.h3,{id:"onboarding-steps-summary",children:"Onboarding Steps Summary"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Step"}),(0,a.jsx)(n.th,{children:"Action"}),(0,a.jsx)(n.th,{children:"Tooling"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"1"}),(0,a.jsx)(n.td,{children:"Create tenant record"}),(0,a.jsx)(n.td,{children:"Control Plane API"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"2"}),(0,a.jsx)(n.td,{children:"Provision database"}),(0,a.jsx)(n.td,{children:"Terraform / Crossplane"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"3"}),(0,a.jsx)(n.td,{children:"Deploy K8s resources"}),(0,a.jsx)(n.td,{children:"ArgoCD + Helm"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"4"}),(0,a.jsx)(n.td,{children:"Configure DNS"}),(0,a.jsx)(n.td,{children:"CloudFlare API"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"5"}),(0,a.jsx)(n.td,{children:"Import initial data"}),(0,a.jsx)(n.td,{children:"Custom data pipeline (Kafka + workers)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"6"}),(0,a.jsx)(n.td,{children:"Activate"}),(0,a.jsx)(n.td,{children:"Feature flag flip + health check"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"tenant-configuration",children:"Tenant Configuration"}),"\n",(0,a.jsx)(n.p,{children:"Each tenant carries a configuration object that controls platform behavior:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# Example: tenant-100.yaml\ntenant:\n  id: tenant-100\n  name: "Acme Retail"\n  tier: enterprise\n  region: us-east-1\n  features:\n    ai_agents: true\n    demand_forecasting: true\n    dynamic_pricing: false       # not enabled for this tenant\n    real_time_analytics: true\n  branding:\n    primary_color: "#1a73e8"\n    logo_url: "https://cdn.godseye.io/tenant-100/logo.svg"\n  integrations:\n    erp: sap_s4hana\n    pos: oracle_xstore\n    payment: adyen\n  compliance:\n    pci_dss_level: 2\n    data_residency: [us-east-1, us-west-2]\n  ai:\n    llm_provider: claude          # tenant-level LLM preference\n    self_hosted_models: false\n    agent_memory_ttl: 30d\n'})}),"\n",(0,a.jsx)(n.h2,{id:"request-routing-with-tenant-context",children:"Request Routing with Tenant Context"}),"\n",(0,a.jsx)(n.p,{children:"Every request entering the platform is stamped with tenant context at the edge and carries it through the entire call chain."}),"\n",(0,a.jsx)(n.mermaid,{value:'graph LR\n    subgraph "Edge"\n        CF[CloudFlare] --\x3e|tenant-100.godseye.io| GW[API Gateway]\n    end\n\n    subgraph "Gateway"\n        GW --\x3e|1. Extract tenant from subdomain| TL[Tenant Lookup]\n        TL --\x3e|2. Load tenant config| TC[Tenant Context]\n        TC --\x3e|3. Inject headers| RQ[Request]\n    end\n\n    subgraph "Headers Propagated"\n        RQ --\x3e|X-Tenant-ID: tenant-100| SVC1[Service A]\n        SVC1 --\x3e|X-Tenant-ID: tenant-100| SVC2[Service B]\n        SVC2 --\x3e|X-Tenant-ID: tenant-100| DB[(Tenant DB)]\n    end\n\n    subgraph "Enforcement Points"\n        EP1[Istio Sidecar: AuthZ check]\n        EP2[ORM: tenant_id scoping]\n        EP3[RLS: PostgreSQL policy]\n    end\n\n    SVC1 -.-> EP1\n    SVC2 -.-> EP2\n    DB -.-> EP3'}),"\n",(0,a.jsx)(n.h2,{id:"scaling-and-noisy-neighbor-prevention",children:"Scaling and Noisy-Neighbor Prevention"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Mechanism"}),(0,a.jsx)(n.th,{children:"Purpose"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"HPA per tenant namespace"})}),(0,a.jsx)(n.td,{children:"Horizontal Pod Autoscaling scoped to each tenant's workloads"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Resource Quotas"})}),(0,a.jsx)(n.td,{children:"CPU/memory limits per namespace prevent a single tenant from starving others"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Priority Classes"})}),(0,a.jsx)(n.td,{children:"Higher-tier tenants get scheduling priority during contention"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Pod Disruption Budgets"})}),(0,a.jsx)(n.td,{children:"Ensure minimum replica counts during cluster operations"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Tenant-aware scheduling"})}),(0,a.jsx)(n.td,{children:"Affinity/anti-affinity rules place enterprise/premium pods on dedicated node pools"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Rate limiting"})}),(0,a.jsx)(n.td,{children:"Per-tenant rate limits at the API gateway (token bucket)"})]})]})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:'# Example: ResourceQuota for a Standard tenant namespace\napiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: tenant-001-quota\n  namespace: tenant-001\nspec:\n  hard:\n    requests.cpu: "4"\n    requests.memory: 8Gi\n    limits.cpu: "8"\n    limits.memory: 16Gi\n    pods: "50"\n    services: "10"\n    persistentvolumeclaims: "5"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>s,x:()=>d});var r=t(6540);const a={},i=r.createContext(a);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);
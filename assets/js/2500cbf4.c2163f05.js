"use strict";(globalThis.webpackChunkgodseye=globalThis.webpackChunkgodseye||[]).push([[7993],{8561(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"systems/payments","title":"\ud83d\udcb3 Payment Gateway Orchestrator","description":"GodsEye payment layer: multi-gateway smart routing, PCI-DSS Level 1 tokenization, offline-capable POS, AI-driven fraud and cost optimization. All gateways remain third-party -- GodsEye never processes raw card data.","source":"@site/docs/systems/payments.md","sourceDirName":"systems","slug":"/systems/payments","permalink":"/godseye/systems/payments","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"\ud83d\udcb3 Payment Gateway Orchestrator"},"sidebar":"architectureSidebar","previous":{"title":"\ud83d\udd10 Authentication & Identity System","permalink":"/godseye/systems/authentication"},"next":{"title":"\ud83c\udf10 Global Load Balancing & Traffic Management","permalink":"/godseye/systems/load-balancing"}}');var a=r(4848),i=r(8453);const s={sidebar_position:2,sidebar_label:"\ud83d\udcb3 Payment Gateway Orchestrator"},d="\ud83d\udcb3 Payment Gateway Orchestrator",l={},o=[{value:"Payment Routing Engine",id:"payment-routing-engine",level:2},{value:"Payment Types",id:"payment-types",level:2},{value:"PCI-DSS Compliance Flow",id:"pci-dss-compliance-flow",level:2},{value:"In-Store Payment Flow",id:"in-store-payment-flow",level:2},{value:"AI in Payments",id:"ai-in-payments",level:2},{value:"Gateway Comparison",id:"gateway-comparison",level:2},{value:"Build vs Buy Strategy",id:"build-vs-buy-strategy",level:2}];function c(e){const n={h1:"h1",h2:"h2",header:"header",mermaid:"mermaid",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"-payment-gateway-orchestrator",children:"\ud83d\udcb3 Payment Gateway Orchestrator"})}),"\n",(0,a.jsx)(n.p,{children:"GodsEye payment layer: multi-gateway smart routing, PCI-DSS Level 1 tokenization, offline-capable POS, AI-driven fraud and cost optimization. All gateways remain third-party -- GodsEye never processes raw card data."}),"\n",(0,a.jsx)(n.h2,{id:"payment-routing-engine",children:"Payment Routing Engine"}),"\n",(0,a.jsx)(n.mermaid,{value:'flowchart TD\n    REQ["Payment Request<br/>(amount, currency, card type,<br/>region, channel)"]\n    FC["AI Fraud Check<br/>(<100ms, real-time scoring)"]\n    FS{Fraud Score}\n    BLOCK["BLOCK Transaction<br/>+ Alert Security Team<br/>+ Notify Customer"]\n    SR["Smart Router"]\n\n    REQ --\x3e FC\n    FC --\x3e FS\n    FS --\x3e|"Score > Threshold"| BLOCK\n    FS --\x3e|"Score OK"| SR\n\n    subgraph ROUTING_LOGIC["Routing Decision Factors"]\n        RL1["Gateway Health<br/>(real-time latency + error rate)"]\n        RL2["Cost Optimization<br/>(interchange + gateway fee)"]\n        RL3["Card Type / Brand<br/>(Visa, MC, Amex, Discover)"]\n        RL4["Region<br/>(domestic vs cross-border)"]\n        RL5["Historical Success Rate<br/>(per gateway per card BIN)"]\n    end\n\n    SR --\x3e ROUTING_LOGIC\n    ROUTING_LOGIC --\x3e PG\n\n    PG["Primary Gateway<br/>(selected by Smart Router)"]\n    PG --\x3e PG_R{Response}\n    PG_R --\x3e|"Approved"| DONE["Transaction Complete<br/>Log + Receipt"]\n    PG_R --\x3e|"Declined / Timeout"| RETRY["Retry Once<br/>(same gateway, new request ID)"]\n    RETRY --\x3e RETRY_R{Response}\n    RETRY_R --\x3e|"Approved"| DONE\n    RETRY_R --\x3e|"Declined / Timeout"| SG["Route to Secondary Gateway<br/>(<2 seconds total)"]\n    SG --\x3e SG_R{Response}\n    SG_R --\x3e|"Approved"| DONE\n    SG_R --\x3e|"Declined / Timeout"| TG["Route to Tertiary Gateway"]\n    TG --\x3e TG_R{Response}\n    TG_R --\x3e|"Approved"| DONE\n    TG_R --\x3e|"All Failed"| OFFLINE["POS: Store & Forward<br/>Web: Show alt payment options"]\n\n    subgraph GATEWAYS["Available Gateways"]\n        G1["Stripe"]\n        G2["Adyen"]\n        G3["Square"]\n        G4["Worldpay"]\n        G5["Checkout.com"]\n    end'}),"\n",(0,a.jsx)(n.h2,{id:"payment-types",children:"Payment Types"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph TD\n    PAY["GodsEye Payment<br/>Orchestrator"]\n\n    subgraph CARDS["Credit / Debit Cards"]\n        VISA["Visa"]\n        MC["Mastercard"]\n        AMEX["American Express"]\n        DISC["Discover / Diners"]\n        PIN["PIN Debit"]\n    end\n\n    subgraph WALLETS["Digital Wallets"]\n        APPLE["Apple Pay"]\n        GOOGLE["Google Pay"]\n        SAMSUNG["Samsung Pay"]\n    end\n\n    subgraph BNPL["Buy Now Pay Later"]\n        KLARNA["Klarna"]\n        AFTERPAY["Afterpay"]\n        AFFIRM["Affirm"]\n    end\n\n    subgraph STORED["Stored Value"]\n        GIFT["Gift Cards"]\n        CREDIT["Store Credit"]\n        LOYALTY["Loyalty Points<br/>Redemption"]\n    end\n\n    subgraph SPLIT["Split Tender"]\n        SP1["Partial card<br/>+ gift card"]\n        SP2["Partial card<br/>+ loyalty points"]\n        SP3["Multiple cards"]\n        SP4["Card + BNPL"]\n    end\n\n    PAY --\x3e CARDS\n    PAY --\x3e WALLETS\n    PAY --\x3e BNPL\n    PAY --\x3e STORED\n    PAY --\x3e SPLIT\n\n    SPLIT -.->|"combines"| CARDS\n    SPLIT -.->|"combines"| STORED\n    SPLIT -.->|"combines"| BNPL'}),"\n",(0,a.jsx)(n.h2,{id:"pci-dss-compliance-flow",children:"PCI-DSS Compliance Flow"}),"\n",(0,a.jsx)(n.mermaid,{value:'flowchart TD\n    subgraph ENTRY["Card Data Entry Points"]\n        POS_T["POS Terminal<br/>(P2PE encrypted at hardware)"]\n        WEB["Web Checkout<br/>(Stripe.js / Adyen Drop-in)"]\n        MOB["Mobile App<br/>(SDK tokenization)"]\n    end\n\n    TOK["Tokenization Layer<br/>(card data --\x3e opaque token)<br/>Card number NEVER enters GodsEye"]\n\n    subgraph VAULT["Token Vault (Multi-Cloud)"]\n        V_AWS["AWS Vault<br/>(CloudHSM-backed)"]\n        V_GCP["GCP Vault<br/>(Cloud KMS-backed)"]\n        V_AZ["Azure Vault<br/>(Managed HSM-backed)"]\n        V_AWS <--\x3e|"sync"| V_GCP\n        V_GCP <--\x3e|"sync"| V_AZ\n    end\n\n    GW["Payment Gateway<br/>(handles actual card data)"]\n    PROC["Card Network<br/>(Visa / MC / Amex)"]\n\n    POS_T --\x3e|"encrypted payload"| TOK\n    WEB --\x3e|"client-side tokenized"| TOK\n    MOB --\x3e|"SDK tokenized"| TOK\n\n    TOK --\x3e VAULT\n    VAULT --\x3e|"token reference"| GW\n    GW --\x3e|"raw card data<br/>(gateway scope only)"| PROC\n    PROC --\x3e|"auth response"| GW\n    GW --\x3e|"result"| TOK\n\n    subgraph SCOPE["PCI-DSS Scope"]\n        S1["GodsEye: PCI-DSS Level 1<br/>SAQ D (service provider)"]\n        S2["Scope minimized via:<br/>- P2PE at terminal<br/>- Client-side tokenization<br/>- No card storage<br/>- Token vault is PCI-certified"]\n    end\n\n    style TOK fill:#f96,stroke:#333,stroke-width:2px\n    style VAULT fill:#ff9,stroke:#333,stroke-width:2px'}),"\n",(0,a.jsx)(n.h2,{id:"in-store-payment-flow",children:"In-Store Payment Flow"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant CUST as Customer\n    participant TERM as Payment Terminal<br/>(P2PE)\n    participant POS as POS Application\n    participant ORCH as Payment Orchestrator\n    participant FRAUD as Fraud Engine\n    participant GW as Payment Gateway\n    participant NET as Card Network\n\n    Note over CUST,NET: Online Flow\n    CUST->>TERM: Tap / Insert / Swipe card\n    TERM->>TERM: P2PE encrypt card data\n    TERM->>POS: Encrypted payload + amount\n    POS->>ORCH: Payment request<br/>(encrypted card, amount,<br/>store ID, terminal ID)\n    ORCH->>FRAUD: Real-time fraud check\n    FRAUD->>FRAUD: AI scoring (<100ms)<br/>velocity, geolocation,<br/>device trust, amount pattern\n    FRAUD->>ORCH: Score: PASS (score=12)\n\n    ORCH->>ORCH: Smart route selection<br/>(lowest cost + highest success)\n    ORCH->>GW: Authorization request\n    GW->>NET: Card authorization\n    NET->>GW: Approved (auth code: 847291)\n    GW->>ORCH: Approved\n    ORCH->>POS: Approved + auth code\n    POS->>TERM: Display APPROVED\n    POS->>POS: Generate receipt<br/>(print + email + SMS)\n    POS->>ORCH: Confirm transaction logged\n\n    Note over CUST,NET: Offline Flow (Internet Down)\n    CUST->>TERM: Tap / Insert / Swipe card\n    TERM->>TERM: P2PE encrypt card data\n    TERM->>POS: Encrypted payload + amount\n    POS->>POS: Detect: NO connectivity\n    POS->>POS: Local fraud rules<br/>(floor limit check, velocity,<br/>hot card list)\n\n    alt Amount < Floor Limit ($50) AND card not on hot list\n        POS->>POS: APPROVE offline<br/>(store & forward)\n        POS->>TERM: Display APPROVED (OFFLINE)\n        POS->>POS: Queue transaction<br/>(encrypted, signed)\n    else Amount > Floor Limit OR card on hot list\n        POS->>TERM: Display DECLINED<br/>(request alternate payment)\n    end\n\n    Note over CUST,NET: Reconnection\n    POS->>ORCH: Batch sync queued transactions\n    ORCH->>GW: Process queued authorizations\n    GW->>NET: Late authorization\n    NET->>GW: Approved / Declined\n    GW->>ORCH: Results\n    ORCH->>POS: Reconciliation report<br/>(flag any declined offline txns)"}),"\n",(0,a.jsx)(n.h2,{id:"ai-in-payments",children:"AI in Payments"}),"\n",(0,a.jsx)(n.mermaid,{value:'graph TD\n    AI["AI / ML Payment<br/>Intelligence Layer"]\n\n    subgraph FRAUD_AI["Fraud Scoring (<100ms)"]\n        FA1["Transaction velocity analysis"]\n        FA2["Geolocation anomaly detection"]\n        FA3["Device trust scoring"]\n        FA4["Behavioral biometrics"]\n        FA5["Card BIN risk profiling"]\n        FA6["Network graph analysis<br/>(linked fraud rings)"]\n    end\n\n    subgraph ROUTING_AI["Dynamic Routing Optimization"]\n        RA1["Save 0.1-0.3% on<br/>processing fees"]\n        RA2["Real-time gateway<br/>performance scoring"]\n        RA3["Interchange optimization<br/>(card-present vs not-present)"]\n        RA4["Cross-border routing<br/>optimization"]\n    end\n\n    subgraph RECOVERY_AI["Failed Payment Recovery"]\n        RE1["Smart retry timing<br/>(optimal retry windows)"]\n        RE2["Dunning optimization<br/>(subscription recovery)"]\n        RE3["Alternative payment<br/>method suggestion"]\n        RE4["Decline reason analysis<br/>+ auto-fix"]\n    end\n\n    subgraph CHARGEBACK_AI["Chargeback Prevention"]\n        CB1["Pre-dispute alerts<br/>(Verifi / Ethoca)"]\n        CB2["Chargeback probability<br/>scoring at auth time"]\n        CB3["Auto-generate<br/>compelling evidence"]\n        CB4["Pattern detection<br/>(friendly fraud)"]\n    end\n\n    subgraph ANOMALY_AI["Anomaly Detection"]\n        AN1["Unusual transaction<br/>volume spikes"]\n        AN2["Gateway degradation<br/>early warning"]\n        AN3["Terminal compromise<br/>detection"]\n        AN4["Refund abuse patterns"]\n    end\n\n    AI --\x3e FRAUD_AI\n    AI --\x3e ROUTING_AI\n    AI --\x3e RECOVERY_AI\n    AI --\x3e CHARGEBACK_AI\n    AI --\x3e ANOMALY_AI'}),"\n",(0,a.jsx)(n.h2,{id:"gateway-comparison",children:"Gateway Comparison"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Capability"}),(0,a.jsx)(n.th,{children:"Stripe"}),(0,a.jsx)(n.th,{children:"Adyen"}),(0,a.jsx)(n.th,{children:"Square"}),(0,a.jsx)(n.th,{children:"Worldpay"}),(0,a.jsx)(n.th,{children:"Checkout.com"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Card Present (POS)"})}),(0,a.jsx)(n.td,{children:"Via Terminal API"}),(0,a.jsx)(n.td,{children:"Native"}),(0,a.jsx)(n.td,{children:"Native"}),(0,a.jsx)(n.td,{children:"Native"}),(0,a.jsx)(n.td,{children:"Limited"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Card Not Present (Web)"})}),(0,a.jsx)(n.td,{children:"Native"}),(0,a.jsx)(n.td,{children:"Native"}),(0,a.jsx)(n.td,{children:"Native"}),(0,a.jsx)(n.td,{children:"Native"}),(0,a.jsx)(n.td,{children:"Native"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Apple Pay / Google Pay"})}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"BNPL Integration"})}),(0,a.jsx)(n.td,{children:"Klarna, Afterpay"}),(0,a.jsx)(n.td,{children:"Klarna, Afterpay, Affirm"}),(0,a.jsx)(n.td,{children:"Afterpay (owned)"}),(0,a.jsx)(n.td,{children:"Limited"}),(0,a.jsx)(n.td,{children:"Klarna"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Multi-Currency"})}),(0,a.jsx)(n.td,{children:"135+ currencies"}),(0,a.jsx)(n.td,{children:"150+ currencies"}),(0,a.jsx)(n.td,{children:"Limited"}),(0,a.jsx)(n.td,{children:"120+ currencies"}),(0,a.jsx)(n.td,{children:"150+ currencies"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Regions"})}),(0,a.jsx)(n.td,{children:"Global"}),(0,a.jsx)(n.td,{children:"Global"}),(0,a.jsx)(n.td,{children:"US, CA, AU, JP, UK, EU"}),(0,a.jsx)(n.td,{children:"Global"}),(0,a.jsx)(n.td,{children:"Global"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Interchange++"})}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"No (flat rate)"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Typical Blended Rate"})}),(0,a.jsx)(n.td,{children:"2.9% + $0.30"}),(0,a.jsx)(n.td,{children:"2.6% + $0.10"}),(0,a.jsx)(n.td,{children:"2.6% + $0.10"}),(0,a.jsx)(n.td,{children:"2.5% + $0.10"}),(0,a.jsx)(n.td,{children:"2.5% + $0.20"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Tokenization Vault"})}),(0,a.jsx)(n.td,{children:"Yes (native)"}),(0,a.jsx)(n.td,{children:"Yes (native)"}),(0,a.jsx)(n.td,{children:"Yes (native)"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes (native)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Real-Time Reporting"})}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Yes"}),(0,a.jsx)(n.td,{children:"Delayed"}),(0,a.jsx)(n.td,{children:"Yes"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Primary Use in GodsEye"})}),(0,a.jsx)(n.td,{children:"E-commerce default"}),(0,a.jsx)(n.td,{children:"Enterprise / global"}),(0,a.jsx)(n.td,{children:"In-store (SMB tier)"}),(0,a.jsx)(n.td,{children:"High-volume routing"}),(0,a.jsx)(n.td,{children:"EU / UK primary"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"build-vs-buy-strategy",children:"Build vs Buy Strategy"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Component"}),(0,a.jsx)(n.th,{children:"Phase 1 (Launch)"}),(0,a.jsx)(n.th,{children:"Phase 2 (Scale)"}),(0,a.jsx)(n.th,{children:"Long-Term"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Payment Gateways"})}),(0,a.jsx)(n.td,{children:"Stripe + Square"}),(0,a.jsx)(n.td,{children:"Add Adyen + Worldpay"}),(0,a.jsx)(n.td,{children:"All remain third-party (NEVER build own)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Smart Router"})}),(0,a.jsx)(n.td,{children:"Simple rules engine"}),(0,a.jsx)(n.td,{children:"ML-based optimization"}),(0,a.jsx)(n.td,{children:"Own routing engine (core IP)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Fraud Engine"})}),(0,a.jsx)(n.td,{children:"Stripe Radar + basic rules"}),(0,a.jsx)(n.td,{children:"Add Sardine / Sift"}),(0,a.jsx)(n.td,{children:"Own ML models + third-party signals"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Tokenization Vault"})}),(0,a.jsx)(n.td,{children:"Stripe tokens + VGS"}),(0,a.jsx)(n.td,{children:"VGS multi-gateway"}),(0,a.jsx)(n.td,{children:"Own vault (HSM-backed, multi-cloud)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Chargeback Mgmt"})}),(0,a.jsx)(n.td,{children:"Manual + Stripe tools"}),(0,a.jsx)(n.td,{children:"Chargeflow / Midigator"}),(0,a.jsx)(n.td,{children:"Own system + third-party alert networks"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Reconciliation"})}),(0,a.jsx)(n.td,{children:"Per-gateway reports"}),(0,a.jsx)(n.td,{children:"Aggregated dashboard"}),(0,a.jsx)(n.td,{children:"Own real-time reconciliation engine"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"POS Terminal Mgmt"})}),(0,a.jsx)(n.td,{children:"Square Terminal / Stripe Terminal"}),(0,a.jsx)(n.td,{children:"Multi-vendor support"}),(0,a.jsx)(n.td,{children:"Own terminal management platform"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453(e,n,r){r.d(n,{R:()=>s,x:()=>d});var t=r(6540);const a={},i=t.createContext(a);function s(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);
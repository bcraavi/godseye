<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-ai/triplet-loss-architecture" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Triplet Loss Embedding Architecture | GodsEye</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://bcraavi.github.io/godseye/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://bcraavi.github.io/godseye/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://bcraavi.github.io/godseye/ai/triplet-loss-architecture"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Triplet Loss Embedding Architecture | GodsEye"><meta data-rh="true" name="description" content="GodsEye uses triplet loss to learn unified product embeddings powering visual search, product matching, recommendations, and fraud detection. All training, serving, and storage runs on the Big 3 cloud providers (AWS primary, GCP secondary, Azure tertiary) â€” no private data centers."><meta data-rh="true" property="og:description" content="GodsEye uses triplet loss to learn unified product embeddings powering visual search, product matching, recommendations, and fraud detection. All training, serving, and storage runs on the Big 3 cloud providers (AWS primary, GCP secondary, Azure tertiary) â€” no private data centers."><link data-rh="true" rel="icon" href="/godseye/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://bcraavi.github.io/godseye/ai/triplet-loss-architecture"><link data-rh="true" rel="alternate" href="https://bcraavi.github.io/godseye/ai/triplet-loss-architecture" hreflang="en"><link data-rh="true" rel="alternate" href="https://bcraavi.github.io/godseye/ai/triplet-loss-architecture" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ¯ Triplet Loss Embeddings","item":"https://bcraavi.github.io/godseye/ai/triplet-loss-architecture"}]}</script><link rel="stylesheet" href="/godseye/assets/css/styles.f2670d54.css">
<script src="/godseye/assets/js/runtime~main.d7b43d23.js" defer="defer"></script>
<script src="/godseye/assets/js/main.ff635298.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/godseye/"><b class="navbar__title text--truncate">GodsEye</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/godseye/">Architecture</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/godseye-platform/godseye" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/godseye/"><span title="ğŸ”­ GodsEye Platform Architecture" class="linkLabel_WmDU">ğŸ”­ GodsEye Platform Architecture</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/godseye/architecture/five-layers"><span title="ğŸ—ï¸ Architecture" class="categoryLinkLabel_W154">ğŸ—ï¸ Architecture</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/architecture/five-layers"><span title="ğŸ“ Five-Layer Architecture" class="linkLabel_WmDU">ğŸ“ Five-Layer Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/architecture/infrastructure"><span title="â˜ï¸ Multi-Cloud Infrastructure" class="linkLabel_WmDU">â˜ï¸ Multi-Cloud Infrastructure</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/architecture/engineering-platform"><span title="ğŸ› ï¸ Engineering Platform" class="linkLabel_WmDU">ğŸ› ï¸ Engineering Platform</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/architecture/ai-engine"><span title="ğŸ§  AI &amp; Intelligence Engine" class="linkLabel_WmDU">ğŸ§  AI &amp; Intelligence Engine</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/architecture/business-operations"><span title="ğŸ’¼ Business Operations" class="linkLabel_WmDU">ğŸ’¼ Business Operations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/architecture/customer-experience"><span title="ğŸ›ï¸ Customer Experience Layer" class="linkLabel_WmDU">ğŸ›ï¸ Customer Experience Layer</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/godseye/systems/authentication"><span title="âš™ï¸ Core Systems" class="categoryLinkLabel_W154">âš™ï¸ Core Systems</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/systems/authentication"><span title="ğŸ” Authentication &amp; Identity System" class="linkLabel_WmDU">ğŸ” Authentication &amp; Identity System</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/systems/payments"><span title="ğŸ’³ Payment Gateway Orchestrator" class="linkLabel_WmDU">ğŸ’³ Payment Gateway Orchestrator</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/systems/load-balancing"><span title="ğŸŒ Global Load Balancing &amp; Traffic Management" class="linkLabel_WmDU">ğŸŒ Global Load Balancing &amp; Traffic Management</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/systems/data-sync"><span title="ğŸ”„ Cross-Cloud Data Synchronization" class="linkLabel_WmDU">ğŸ”„ Cross-Cloud Data Synchronization</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/systems/pos"><span title="ğŸ–¥ï¸ Point of Sale System" class="linkLabel_WmDU">ğŸ–¥ï¸ Point of Sale System</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/systems/commerce-engine"><span title="ğŸ›’ Headless Commerce Engine" class="linkLabel_WmDU">ğŸ›’ Headless Commerce Engine</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/godseye/ai/agent-mesh"><span title="ğŸ¤– AI Agents" class="categoryLinkLabel_W154">ğŸ¤– AI Agents</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/ai/agent-mesh"><span title="ğŸ•¸ï¸ AI Agent Mesh" class="linkLabel_WmDU">ğŸ•¸ï¸ AI Agent Mesh</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/ai/customer-ai"><span title="ğŸ›’ Customer AI Agents" class="linkLabel_WmDU">ğŸ›’ Customer AI Agents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/ai/operations-ai"><span title="âš¡ Operations AI Agents" class="linkLabel_WmDU">âš¡ Operations AI Agents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/ai/business-ai"><span title="ğŸ“Š Business AI Agents" class="linkLabel_WmDU">ğŸ“Š Business AI Agents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/ai/project-sentinels"><span title="ğŸ›¡ï¸ Project Sentinel Agents" class="linkLabel_WmDU">ğŸ›¡ï¸ Project Sentinel Agents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/godseye/ai/triplet-loss-architecture"><span title="ğŸ¯ Triplet Loss Embeddings" class="linkLabel_WmDU">ğŸ¯ Triplet Loss Embeddings</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/godseye/strategy/build-vs-buy"><span title="ğŸ“‹ Strategy" class="categoryLinkLabel_W154">ğŸ“‹ Strategy</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/strategy/build-vs-buy"><span title="ğŸ”¨ Build vs Buy Strategy" class="linkLabel_WmDU">ğŸ”¨ Build vs Buy Strategy</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/strategy/multi-cloud"><span title="â˜ï¸ Multi-Cloud Strategy" class="linkLabel_WmDU">â˜ï¸ Multi-Cloud Strategy</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/strategy/multi-tenant"><span title="ğŸ¢ Multi-Tenant Architecture" class="linkLabel_WmDU">ğŸ¢ Multi-Tenant Architecture</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/strategy/triplet-model"><span title="ğŸ”º Triplet Model" class="linkLabel_WmDU">ğŸ”º Triplet Model</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/strategy/tech-stack"><span title="ğŸ”§ Technology Stack" class="linkLabel_WmDU">ğŸ”§ Technology Stack</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/strategy/open-core"><span title="ğŸ’° Open-Core Strategy" class="linkLabel_WmDU">ğŸ’° Open-Core Strategy</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/godseye/strategy/community"><span title="ğŸ¤ Community Strategy" class="linkLabel_WmDU">ğŸ¤ Community Strategy</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/godseye/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ğŸ¤– AI Agents</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ğŸ¯ Triplet Loss Embeddings</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ğŸ¯ Triplet Loss Embedding Architecture</h1></header>
<p>GodsEye uses <strong>triplet loss</strong> to learn unified product embeddings powering visual search, product matching, recommendations, and fraud detection. All training, serving, and storage runs on the <strong>Big 3 cloud providers</strong> (AWS primary, GCP secondary, Azure tertiary) â€” no private data centers.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-triplet-loss-for-retail">Why Triplet Loss for Retail<a href="#why-triplet-loss-for-retail" class="hash-link" aria-label="Direct link to Why Triplet Loss for Retail" title="Direct link to Why Triplet Loss for Retail" translate="no">â€‹</a></h2>
<table><thead><tr><th>Approach</th><th>Pros</th><th>Cons</th><th>GodsEye Fit</th></tr></thead><tbody><tr><td><strong>Triplet Loss</strong></td><td>Fine-grained similarity, works across modalities, proven at scale</td><td>Hard negative mining needed, slower convergence</td><td><strong>Primary</strong> â€” best for product matching</td></tr><tr><td>Contrastive Loss</td><td>Simple, fast to train</td><td>Binary (same/different), loses nuance</td><td>Fallback for cold-start categories</td></tr><tr><td>Cross-Entropy Classification</td><td>Fast, well-understood</td><td>Fixed label set, can&#x27;t handle new products</td><td>Not suitable â€” catalog changes daily</td></tr><tr><td>ArcFace / CosFace</td><td>Strong angular margins</td><td>Needs large balanced classes</td><td>Complementary for brand/category</td></tr></tbody></table>
<p><strong>Triplet loss</strong> is ideal because GodsEye&#x27;s catalog has millions of SKUs with continuous additions, requiring an embedding space that generalizes to unseen products without retraining the classification head.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="triplet-loss-formulation">Triplet Loss Formulation<a href="#triplet-loss-formulation" class="hash-link" aria-label="Direct link to Triplet Loss Formulation" title="Direct link to Triplet Loss Formulation" translate="no">â€‹</a></h2>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">L(a, p, n) = max(0, â€–f(a) - f(p)â€–Â² - â€–f(a) - f(n)â€–Â² + margin)</span><br></span></code></pre></div></div>
<table><thead><tr><th>Symbol</th><th>Meaning</th><th>GodsEye Example</th></tr></thead><tbody><tr><td><code>a</code></td><td>Anchor</td><td>Product image/text of &quot;Nike Air Max 90 Black&quot;</td></tr><tr><td><code>p</code></td><td>Positive</td><td>Same product â€” different angle, listing, or store</td></tr><tr><td><code>n</code></td><td>Negative</td><td>Different product â€” &quot;Adidas Ultraboost White&quot;</td></tr><tr><td><code>f(Â·)</code></td><td>Encoder</td><td>ViT-L/14 backbone â†’ 512-dim embedding</td></tr><tr><td><code>margin</code></td><td>Min gap</td><td>0.3 (tuned per category)</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="end-to-end-pipeline">End-to-End Pipeline<a href="#end-to-end-pipeline" class="hash-link" aria-label="Direct link to End-to-End Pipeline" title="Direct link to End-to-End Pipeline" translate="no">â€‹</a></h2>
<!-- -->
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="model-architecture">Model Architecture<a href="#model-architecture" class="hash-link" aria-label="Direct link to Model Architecture" title="Direct link to Model Architecture" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="base-encoder">Base Encoder<a href="#base-encoder" class="hash-link" aria-label="Direct link to Base Encoder" title="Direct link to Base Encoder" translate="no">â€‹</a></h3>
<!-- -->
<table><thead><tr><th>Component</th><th>Choice</th><th>Rationale</th></tr></thead><tbody><tr><td>Image backbone</td><td>ViT-L/14 (CLIP pretrained)</td><td>Best transfer learning for product images, open-source</td></tr><tr><td>Text backbone</td><td>Fine-tuned BERT-base</td><td>Retail domain vocabulary, attribute-aware</td></tr><tr><td>Fusion</td><td>Late fusion (concat + project)</td><td>Modality-independent, handles missing text/images</td></tr><tr><td>Embedding dim</td><td>512</td><td>Balance between expressiveness and storage/latency</td></tr><tr><td>Normalization</td><td>L2 unit sphere</td><td>Cosine similarity = dot product, faster ANN</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="training-hyperparameters">Training Hyperparameters<a href="#training-hyperparameters" class="hash-link" aria-label="Direct link to Training Hyperparameters" title="Direct link to Training Hyperparameters" translate="no">â€‹</a></h3>
<table><thead><tr><th>Parameter</th><th>Value</th><th>Notes</th></tr></thead><tbody><tr><td>Triplet margin</td><td>0.3</td><td>Tuned per top-level category</td></tr><tr><td>Mining strategy</td><td>Semi-hard + hard (50/50)</td><td>Avoids collapse, maintains gradient signal</td></tr><tr><td>Batch size</td><td>4096</td><td>Large batches for better in-batch mining</td></tr><tr><td>Learning rate</td><td>1e-4 (cosine decay)</td><td>Warm-up 1000 steps</td></tr><tr><td>Epochs</td><td>20</td><td>Early stopping on Recall@10</td></tr><tr><td>Optimizer</td><td>AdamW (weight decay 0.01)</td><td>Prevents overfitting on popular SKUs</td></tr><tr><td>Image augmentation</td><td>RandomCrop, ColorJitter, HorizontalFlip</td><td>Simulates real-world photo variation</td></tr><tr><td>Hard negative ratio</td><td>30% of batch</td><td>Refreshed every 5 epochs via full-index ANN</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="triplet-mining-strategies">Triplet Mining Strategies<a href="#triplet-mining-strategies" class="hash-link" aria-label="Direct link to Triplet Mining Strategies" title="Direct link to Triplet Mining Strategies" translate="no">â€‹</a></h2>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="positive-pair-sources">Positive Pair Sources<a href="#positive-pair-sources" class="hash-link" aria-label="Direct link to Positive Pair Sources" title="Direct link to Positive Pair Sources" translate="no">â€‹</a></h3>
<table><thead><tr><th>Source</th><th>Example</th><th>Weight</th></tr></thead><tbody><tr><td>Same SKU, different image</td><td>Front vs back photo of same shoe</td><td>0.35</td></tr><tr><td>Same product, different seller</td><td>Same Nike Air Max from 2 vendors</td><td>0.25</td></tr><tr><td>Co-purchased together</td><td>Phone + same-brand case</td><td>0.15</td></tr><tr><td>Same product, text variation</td><td>&quot;Nike AM90&quot; vs &quot;Nike Air Max 90&quot;</td><td>0.15</td></tr><tr><td>Human-labeled duplicates</td><td>Catalog dedup ground truth</td><td>0.10</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cloud-infrastructure--big-3-only">Cloud Infrastructure â€” Big 3 Only<a href="#cloud-infrastructure--big-3-only" class="hash-link" aria-label="Direct link to Cloud Infrastructure â€” Big 3 Only" title="Direct link to Cloud Infrastructure â€” Big 3 Only" translate="no">â€‹</a></h2>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cloud-role-assignment">Cloud Role Assignment<a href="#cloud-role-assignment" class="hash-link" aria-label="Direct link to Cloud Role Assignment" title="Direct link to Cloud Role Assignment" translate="no">â€‹</a></h3>
<table><thead><tr><th>Concern</th><th>AWS (Primary)</th><th>GCP (Secondary)</th><th>Azure (Tertiary)</th></tr></thead><tbody><tr><td><strong>Training</strong></td><td>SageMaker â€” full training runs, hyperparameter tuning</td><td>Vertex AI â€” validation runs, A/B model evaluation</td><td>Azure ML â€” disaster recovery, quarterly retraining</td></tr><tr><td><strong>Data Store</strong></td><td>S3 â€” source of truth (50TB images, 2TB text)</td><td>GCS â€” replicated via cross-cloud sync</td><td>Azure Blob â€” replicated, cold tier</td></tr><tr><td><strong>Inference</strong></td><td>EKS (g5.2xlarge) â€” US-East, US-West</td><td>GKE (g2-standard-8) â€” US-Central, EU</td><td>AKS (NC A100) â€” APAC, DR failover</td></tr><tr><td><strong>Vector DB</strong></td><td>Pinecone (primary) + Weaviate on EKS</td><td>Weaviate on GKE (read replica)</td><td>Weaviate on AKS (read replica)</td></tr><tr><td><strong>Orchestration</strong></td><td>SageMaker Pipelines + Step Functions</td><td>Vertex AI Pipelines</td><td>Azure ML Pipelines</td></tr><tr><td><strong>Model Registry</strong></td><td>SageMaker Model Registry (source of truth)</td><td>Vertex AI Model Registry (synced)</td><td>Azure ML Model Registry (synced)</td></tr><tr><td><strong>Cost</strong></td><td>~70% of ML budget</td><td>~20% of ML budget</td><td>~10% of ML budget</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cross-cloud-data-sync">Cross-Cloud Data Sync<a href="#cross-cloud-data-sync" class="hash-link" aria-label="Direct link to Cross-Cloud Data Sync" title="Direct link to Cross-Cloud Data Sync" translate="no">â€‹</a></h3>
<!-- -->
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="vector-search--serving">Vector Search &amp; Serving<a href="#vector-search--serving" class="hash-link" aria-label="Direct link to Vector Search &amp; Serving" title="Direct link to Vector Search &amp; Serving" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="embedding-service-architecture">Embedding Service Architecture<a href="#embedding-service-architecture" class="hash-link" aria-label="Direct link to Embedding Service Architecture" title="Direct link to Embedding Service Architecture" translate="no">â€‹</a></h3>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="latency-budget">Latency Budget<a href="#latency-budget" class="hash-link" aria-label="Direct link to Latency Budget" title="Direct link to Latency Budget" translate="no">â€‹</a></h3>
<table><thead><tr><th>Stage</th><th>Target</th><th>P99 Budget</th></tr></thead><tbody><tr><td>Image preprocessing</td><td>&lt; 5ms</td><td>8ms</td></tr><tr><td>Embedding inference (GPU)</td><td>&lt; 15ms</td><td>25ms</td></tr><tr><td>Redis cache lookup</td><td>&lt; 2ms</td><td>5ms</td></tr><tr><td>ANN search (top-100)</td><td>&lt; 10ms</td><td>15ms</td></tr><tr><td>Metadata enrichment</td><td>&lt; 5ms</td><td>8ms</td></tr><tr><td><strong>Total (cache hit)</strong></td><td><strong>&lt; 7ms</strong></td><td><strong>13ms</strong></td></tr><tr><td><strong>Total (cache miss)</strong></td><td><strong>&lt; 37ms</strong></td><td><strong>61ms</strong></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="index-configuration">Index Configuration<a href="#index-configuration" class="hash-link" aria-label="Direct link to Index Configuration" title="Direct link to Index Configuration" translate="no">â€‹</a></h3>
<table><thead><tr><th>Parameter</th><th>Value</th><th>Rationale</th></tr></thead><tbody><tr><td>Algorithm</td><td>HNSW</td><td>Best recall/latency tradeoff at 50M+ scale</td></tr><tr><td>Dimensions</td><td>512</td><td>Matches projection head output</td></tr><tr><td>Metric</td><td>Cosine similarity</td><td>L2-normalized embeddings, equivalent to dot product</td></tr><tr><td>ef_construction</td><td>200</td><td>High-quality graph at build time</td></tr><tr><td>M</td><td>32</td><td>Connections per node, balances memory vs recall</td></tr><tr><td>ef_search</td><td>100</td><td>Tuned for Recall@10 &gt; 98%</td></tr><tr><td>Shards</td><td>8</td><td>~6M vectors per shard</td></tr><tr><td>Replicas</td><td>3 (per cloud region)</td><td>HA + read throughput</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="agent-integration">Agent Integration<a href="#agent-integration" class="hash-link" aria-label="Direct link to Agent Integration" title="Direct link to Agent Integration" translate="no">â€‹</a></h2>
<!-- -->
<table><thead><tr><th>Agent</th><th>Embedding Use Case</th><th>Query Type</th><th>SLA</th></tr></thead><tbody><tr><td>Visual Search</td><td>Customer photo â†’ nearest catalog products</td><td>Single image â†’ top-K</td><td>&lt; 100ms e2e</td></tr><tr><td>Personalization</td><td>User purchase history centroid â†’ similar items</td><td>Batch embed â†’ top-K per user</td><td>&lt; 200ms e2e</td></tr><tr><td>Fraud Detection</td><td>New listing embedding vs known counterfeits</td><td>Single embed â†’ threshold check</td><td>&lt; 50ms e2e</td></tr><tr><td>Inventory Optimization</td><td>Out-of-stock product â†’ substitutes</td><td>Single SKU â†’ top-10 similar</td><td>&lt; 100ms e2e</td></tr><tr><td>Assortment Planning</td><td>Category embedding density â†’ gap detection</td><td>Batch cluster analysis</td><td>Async (minutes)</td></tr><tr><td>Catalog Dedup</td><td>All-pairs distance below threshold</td><td>Batch ANN, nightly</td><td>Async (hours)</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="training-pipeline-orchestration">Training Pipeline Orchestration<a href="#training-pipeline-orchestration" class="hash-link" aria-label="Direct link to Training Pipeline Orchestration" title="Direct link to Training Pipeline Orchestration" translate="no">â€‹</a></h2>
<!-- -->
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="monitoring--evaluation">Monitoring &amp; Evaluation<a href="#monitoring--evaluation" class="hash-link" aria-label="Direct link to Monitoring &amp; Evaluation" title="Direct link to Monitoring &amp; Evaluation" translate="no">â€‹</a></h2>
<table><thead><tr><th>Metric</th><th>Target</th><th>Alert Threshold</th><th>Measured By</th></tr></thead><tbody><tr><td>Recall@1</td><td>&gt; 85%</td><td>&lt; 82%</td><td>Weekly eval on holdout set</td></tr><tr><td>Recall@10</td><td>&gt; 97%</td><td>&lt; 95%</td><td>Weekly eval on holdout set</td></tr><tr><td>MAP@100</td><td>&gt; 0.90</td><td>&lt; 0.87</td><td>Weekly eval on holdout set</td></tr><tr><td>Embedding drift (cosine)</td><td>&lt; 0.05</td><td>&gt; 0.08</td><td>Daily â€” compare new vs old embeddings for same SKUs</td></tr><tr><td>Inference latency (P99)</td><td>&lt; 25ms</td><td>&gt; 40ms</td><td>Continuous â€” CloudWatch / Cloud Monitoring</td></tr><tr><td>Vector index freshness</td><td>&lt; 24h</td><td>&gt; 48h</td><td>Daily â€” check last reindex timestamp</td></tr><tr><td>Cache hit rate</td><td>&gt; 80%</td><td>&lt; 70%</td><td>Continuous â€” Redis metrics</td></tr><tr><td>Cross-cloud model sync lag</td><td>&lt; 1h</td><td>&gt; 4h</td><td>Model registry sync monitor</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="embedding-quality-dashboard">Embedding Quality Dashboard<a href="#embedding-quality-dashboard" class="hash-link" aria-label="Direct link to Embedding Quality Dashboard" title="Direct link to Embedding Quality Dashboard" translate="no">â€‹</a></h3>
<!-- -->
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cost-estimation--monthly">Cost Estimation â€” Monthly<a href="#cost-estimation--monthly" class="hash-link" aria-label="Direct link to Cost Estimation â€” Monthly" title="Direct link to Cost Estimation â€” Monthly" translate="no">â€‹</a></h2>
<table><thead><tr><th>Component</th><th>AWS</th><th>GCP</th><th>Azure</th><th>Total</th></tr></thead><tbody><tr><td>Training (weekly)</td><td>$12,000 (SageMaker p4d)</td><td>$4,000 (Vertex a2-ultra)</td><td>$1,500 (Azure ML ND)</td><td>$17,500</td></tr><tr><td>Inference (GPU pods)</td><td>$8,500 (EKS g5)</td><td>$3,200 (GKE g2)</td><td>$2,000 (AKS NC)</td><td>$13,700</td></tr><tr><td>Vector DB (Pinecone)</td><td>$2,500 (managed)</td><td>â€”</td><td>â€”</td><td>$2,500</td></tr><tr><td>Vector DB (Weaviate)</td><td>$800 (EKS)</td><td>$600 (GKE)</td><td>$400 (AKS)</td><td>$1,800</td></tr><tr><td>Storage (images + models)</td><td>$1,200 (S3)</td><td>$400 (GCS)</td><td>$200 (Blob)</td><td>$1,800</td></tr><tr><td>Redis cache</td><td>$1,500 (ElastiCache)</td><td>$500 (Memorystore)</td><td>$300 (Azure Cache)</td><td>$2,300</td></tr><tr><td>Data transfer (cross-cloud)</td><td>â€”</td><td>â€”</td><td>â€”</td><td>$800</td></tr><tr><td><strong>Total</strong></td><td><strong>$26,500</strong></td><td><strong>$8,700</strong></td><td><strong>$4,400</strong></td><td><strong>$40,400</strong></td></tr></tbody></table>
<blockquote>
<p>Cost Optimization Agent continuously monitors and recommends spot/preemptible instances for training, reserved instances for inference, and storage tiering for cold embeddings.</p>
</blockquote></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/godseye/ai/project-sentinels"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ğŸ›¡ï¸ Project Sentinel Agents</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/godseye/strategy/build-vs-buy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ğŸ”¨ Build vs Buy Strategy</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-triplet-loss-for-retail" class="table-of-contents__link toc-highlight">Why Triplet Loss for Retail</a></li><li><a href="#triplet-loss-formulation" class="table-of-contents__link toc-highlight">Triplet Loss Formulation</a></li><li><a href="#end-to-end-pipeline" class="table-of-contents__link toc-highlight">End-to-End Pipeline</a></li><li><a href="#model-architecture" class="table-of-contents__link toc-highlight">Model Architecture</a><ul><li><a href="#base-encoder" class="table-of-contents__link toc-highlight">Base Encoder</a></li><li><a href="#training-hyperparameters" class="table-of-contents__link toc-highlight">Training Hyperparameters</a></li></ul></li><li><a href="#triplet-mining-strategies" class="table-of-contents__link toc-highlight">Triplet Mining Strategies</a><ul><li><a href="#positive-pair-sources" class="table-of-contents__link toc-highlight">Positive Pair Sources</a></li></ul></li><li><a href="#cloud-infrastructure--big-3-only" class="table-of-contents__link toc-highlight">Cloud Infrastructure â€” Big 3 Only</a><ul><li><a href="#cloud-role-assignment" class="table-of-contents__link toc-highlight">Cloud Role Assignment</a></li><li><a href="#cross-cloud-data-sync" class="table-of-contents__link toc-highlight">Cross-Cloud Data Sync</a></li></ul></li><li><a href="#vector-search--serving" class="table-of-contents__link toc-highlight">Vector Search &amp; Serving</a><ul><li><a href="#embedding-service-architecture" class="table-of-contents__link toc-highlight">Embedding Service Architecture</a></li><li><a href="#latency-budget" class="table-of-contents__link toc-highlight">Latency Budget</a></li><li><a href="#index-configuration" class="table-of-contents__link toc-highlight">Index Configuration</a></li></ul></li><li><a href="#agent-integration" class="table-of-contents__link toc-highlight">Agent Integration</a></li><li><a href="#training-pipeline-orchestration" class="table-of-contents__link toc-highlight">Training Pipeline Orchestration</a></li><li><a href="#monitoring--evaluation" class="table-of-contents__link toc-highlight">Monitoring &amp; Evaluation</a><ul><li><a href="#embedding-quality-dashboard" class="table-of-contents__link toc-highlight">Embedding Quality Dashboard</a></li></ul></li><li><a href="#cost-estimation--monthly" class="table-of-contents__link toc-highlight">Cost Estimation â€” Monthly</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 GodsEye Platform</div></div></div></footer></div>
</body>
</html>